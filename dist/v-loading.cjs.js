'use strict';

const setStyle = (ele, obj) => {
  for (const key of Object.keys(obj)) {
    let value = `${obj[key]}`,
      type = "style";
    if(key === "text")
      type = "innerText";
    if(key === "html")
      type = "innerHTML";
    if(typeof ele[type] === "object")
      ele[type][key] = value;
    else
      ele[type] = value;
  }
};

const clearBorder = (ele, data, duration = 600) => {
  setStyle(ele, {
    "borderBottom": "0 solid transparent",
    "transition": `border-bottom ${duration}ms`
  });
  setTimeout(() => {
    setStyle(ele, {
      "transition": "none"
    });
    (data) && (data.phase = -1);
  }, duration);
};

const clearHeight = (ele, data, duration = 600) => {
  setStyle(ele, {
    height: "0",
    transition: `height ${duration}ms`
  });
  setTimeout(() => {
    setStyle(ele, {
      "transition": "none"
    });
    (data) && (data.phase = -1);
  }, duration);
};

const setBorder = (ele, obj, color = "#f0f0f0") => {
  let { y, bg } = obj;
  bg = bg || color;
  setStyle(ele, {
    "borderBottom": `${y}px solid ${bg}`,
    transition: "none",
  });
};

const setHeight = (ele, obj, color ="#f0f0f0") => {
  let { y, bg } = obj;
  bg = bg || color;
  setStyle(ele, {
    height: `${y}px`,
    background: bg,
    transition: "none"
  });
};

const defaultOptions = {
  time: 300,
  max: 80,
  bg: "#f0f0f0",
  cb: () => {},
  stage1Begin: (ele, obj) => {
    // eslint-disable-next-line no-unused-vars
    let { y, bg } = obj;
    setStyle(ele, {
      text: "下拉刷新",
      color: "#67c23a",
      textAlign: "center",
      lineHeight: `${y}px`
    });
  },
  // eslint-disable-next-line no-unused-vars
  stage2Begin: (ele, obj) => {
    setStyle(ele, {
      text: "松开刷新"
    });
  },
  stage1End: (ele, flag) => {
    if(flag) {
      setStyle(ele, {
        text: "刷新成功"
      });
    } else {
      setStyle(ele,{
        text: "刷新失败",
        color: "#f56c6c"
      });
    }
  },
  stage2End: (ele) => {
    setStyle(ele, {
      text: "刷新中..."
    });
  },
  stage2: () => {},
  duration: 250,
};

const updateDataInStart = (data, e, options) => {
  let ele = options.ele,
  [top, bottom] = topAndBottom(ele);
  if(data.phase === -1 && (top || bottom)) {
    data.start = e.touches[0].pageY;
    data.phase = 0;
    data.top = top;
    data.bottom = bottom;
  }
};
const updateDataInMove = (data, e, options) => {
  let move = e.touches[0].pageY,
    start = data.start,
    ele = options.ele,
    [top, bottom] = topAndBottom(ele),
    y = move - start,
    positive = y >= 0,
    negative = y <= 0;
  if(data.phase === 0 || data.phase === 1) {
    if(top && positive || bottom && negative) {
      data.phase = 1;
      data.y = y;
      data.positive = positive;
      data.negative = negative;
      data.top = top;
      data.bottom = bottom;
    }
  }

  // (data.phase === 0) && (data.phase = 1);
  // if(data.phase === 1) {
  //   data.y = move - start;
  //   data.positive = data.y >= 0;
  //   data.negative = !data.positive;
  //   data.top = ele.scrollTop === 0;
  //   data.bottom = ele.scrollTop + ele.clientHeight === ele.scrollHeight;
  // }
};

const updateDataInCancel = (data, e, options) => {
  // if(data.top || data.bottom) {
  //   (data.phase === 1) && (data.phase = 2)
  // }
  let ele = options.ele,
    [top, bottom ] = topAndBottom(ele);
  data.top = top;
  data.bottom = bottom;
};

const topAndBottom = (ele) => {
  return [
    ele.scrollTop === 0,
    ele.scrollTop + ele.clientHeight >= ele.scrollHeight
  ]
};

class VLoading {
  constructor(ele, options) {
    this.ele = ele;
    this.options = Object.assign(defaultOptions, options, { ele });
    this.data = {
      top: false,     // 是否触顶
      bottom: false,  // 是否触底
      y: 0,           // 路程位移
      start: 0,       // 起点位移
      phase: -1,      // 0:touchstart, 1:touchmove, 2:touchend/cancel, -1, no events
    };
    this.insertTopLoading();
    this.insertBottomLoading();
    this.init();
  }
  insertTopLoading() {
    const loading = this.options.topLoading;
    if(loading)
      return;
    let firstNode = this.ele.firstElementChild,
      div = document.createElement("div");
    setStyle(div, {
      overflow: "hidden"
    });
    this.ele.insertBefore(div, firstNode);
    this.options.topLoading = div;
  }
  insertBottomLoading() {
    const bottomLoading = this.options.bottomLoading;
    if(bottomLoading)
      return;
    let lastNode = this.ele.lastElementChild,
      div = document.createElement("div");
    div.innerText = "上拉加载中...";
    setStyle(div, {
      lineHeight: 2,
      textAlign: "center",
      visibility: "hidden"
    });
    this.ele.insertBefore(div, lastNode.nextSibling);
    this.options.bottomLoading = div;
  }
  init() {
    let ele = this.ele,
      data = this.data,
      topLoading = this.options.topLoading,
      bottomLoading = this.options.bottomLoading,
      cb = this.options.cb,
      max = this.options.max,
      bg = this.options.bg,
      time = this.options.time,
      duration = this.options.duration,
      stage1Begin = this.options.stage1Begin,
      stage2Begin = this.options.stage2Begin,
      stage1End = this.options.stage1End,
      stage2End = this.options.stage2End;
    window.data = data;
    ele.addEventListener("touchstart", (e) => {
      updateDataInStart(data, e, this.options);
    });

    ele.addEventListener("touchmove", (e) => {
      updateDataInMove(data, e, this.options);
      if(data.phase === 0)
        return;
      if(data.phase === -1) {
        return;
      }
      if(data.phase === 2) {
        e.preventDefault();
        return;
      }
      if(data.top) {
        e.preventDefault();
        let y = data.y;

        if(y >= max) {
          y = (y - max) / 2;
          setBorder(topLoading, { y, bg });
          stage2Begin(topLoading, { y, bg });
        } else {
          setHeight(topLoading, { y, bg });
          stage1Begin(topLoading, { y, bg });
        }
      }
      if(data.bottom) {
        setStyle(bottomLoading, {
          visibility: "visible"
        });
      }

      // }
    }, {passive: false});
    ele.addEventListener("touchend", (e) => {
      updateDataInCancel(data, e, this.options);
      if(data.phase === 0) {
        data.phase = -1;
        return;
      }
      if(data.phase === 1) {
        data.phase = 2;
        if(data.top) {
          let y = data.y;
          if(y > max) {
            clearBorder(topLoading,null, duration);
            stage2End(topLoading);
            cb(
              (flag) => {
                stage1End(topLoading,flag);
                setTimeout(() => {
                  clearHeight(topLoading, data, duration);
                }, time);
              }
            );
          } else {
            // stage1End(topLoading);
            clearBorder(topLoading, data, duration);
            clearHeight(topLoading, data, duration);
          }
        }
        if(data.bottom) {
          setStyle(bottomLoading, {
            visibility: "hidden"
          });
          data.phase = -1;
        }
      }
    });
    ele.addEventListener("touchcancel", (e) => {
    });
  }
}

module.exports = VLoading;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidi1sb2FkaW5nLmNqcy5qcyIsInNvdXJjZXMiOlsiLi4vc3JjL3V0aWxzL2luZGV4LmpzIiwiLi4vc3JjL2NvcmUvZGVmYXVsdC5qcyIsIi4uL3NyYy9jb3JlL2hlbHBlcnMuanMiLCIuLi9zcmMvY29yZS9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzZXRTdHlsZSA9IChlbGUsIG9iaikgPT4ge1xyXG4gIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKG9iaikpIHtcclxuICAgIGxldCB2YWx1ZSA9IGAke29ialtrZXldfWAsXHJcbiAgICAgIHR5cGUgPSBcInN0eWxlXCI7XHJcbiAgICBpZihrZXkgPT09IFwidGV4dFwiKVxyXG4gICAgICB0eXBlID0gXCJpbm5lclRleHRcIjtcclxuICAgIGlmKGtleSA9PT0gXCJodG1sXCIpXHJcbiAgICAgIHR5cGUgPSBcImlubmVySFRNTFwiO1xyXG4gICAgaWYodHlwZW9mIGVsZVt0eXBlXSA9PT0gXCJvYmplY3RcIilcclxuICAgICAgZWxlW3R5cGVdW2tleV0gPSB2YWx1ZTtcclxuICAgIGVsc2VcclxuICAgICAgZWxlW3R5cGVdID0gdmFsdWU7XHJcbiAgfVxyXG59O1xyXG5jb25zdCBnZXRTdHlsZSA9IChlbGUsIGF0dHIpID0+IHtcclxuICByZXR1cm4gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShlbGUpW2F0dHJdO1xyXG59O1xyXG5cclxuY29uc3QgY2xlYXJCb3JkZXIgPSAoZWxlLCBkYXRhLCBkdXJhdGlvbiA9IDYwMCkgPT4ge1xyXG4gIHNldFN0eWxlKGVsZSwge1xyXG4gICAgXCJib3JkZXJCb3R0b21cIjogXCIwIHNvbGlkIHRyYW5zcGFyZW50XCIsXHJcbiAgICBcInRyYW5zaXRpb25cIjogYGJvcmRlci1ib3R0b20gJHtkdXJhdGlvbn1tc2BcclxuICB9KTtcclxuICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIHNldFN0eWxlKGVsZSwge1xyXG4gICAgICBcInRyYW5zaXRpb25cIjogXCJub25lXCJcclxuICAgIH0pO1xyXG4gICAgKGRhdGEpICYmIChkYXRhLnBoYXNlID0gLTEpO1xyXG4gIH0sIGR1cmF0aW9uKTtcclxufTtcclxuXHJcbmNvbnN0IGNsZWFySGVpZ2h0ID0gKGVsZSwgZGF0YSwgZHVyYXRpb24gPSA2MDApID0+IHtcclxuICBzZXRTdHlsZShlbGUsIHtcclxuICAgIGhlaWdodDogXCIwXCIsXHJcbiAgICB0cmFuc2l0aW9uOiBgaGVpZ2h0ICR7ZHVyYXRpb259bXNgXHJcbiAgfSk7XHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICBzZXRTdHlsZShlbGUsIHtcclxuICAgICAgXCJ0cmFuc2l0aW9uXCI6IFwibm9uZVwiXHJcbiAgICB9KTtcclxuICAgIChkYXRhKSAmJiAoZGF0YS5waGFzZSA9IC0xKTtcclxuICB9LCBkdXJhdGlvbik7XHJcbn07XHJcblxyXG5jb25zdCBjbGVhckxvYWRpbmdJbWcgPSAoZWxlKSA9PiB7XHJcbiAgc2V0U3R5bGUoZWxlLCB7XHJcbiAgICBiYWNrZ3JvdW5kOiBcIm5vbmVcIlxyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0Qm9yZGVyID0gKGVsZSwgb2JqLCBjb2xvciA9IFwiI2YwZjBmMFwiKSA9PiB7XHJcbiAgbGV0IHsgeSwgYmcgfSA9IG9iajtcclxuICBiZyA9IGJnIHx8IGNvbG9yO1xyXG4gIHNldFN0eWxlKGVsZSwge1xyXG4gICAgXCJib3JkZXJCb3R0b21cIjogYCR7eX1weCBzb2xpZCAke2JnfWAsXHJcbiAgICB0cmFuc2l0aW9uOiBcIm5vbmVcIixcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHNldEhlaWdodCA9IChlbGUsIG9iaiwgY29sb3IgPVwiI2YwZjBmMFwiKSA9PiB7XHJcbiAgbGV0IHsgeSwgYmcgfSA9IG9iajtcclxuICBiZyA9IGJnIHx8IGNvbG9yO1xyXG4gIHNldFN0eWxlKGVsZSwge1xyXG4gICAgaGVpZ2h0OiBgJHt5fXB4YCxcclxuICAgIGJhY2tncm91bmQ6IGJnLFxyXG4gICAgdHJhbnNpdGlvbjogXCJub25lXCJcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHNldExvYWRpbmdJbWcgPSAoZWxlLCBzcmM9XCIuL2xvYWRpbmcuZ2lmXCIpID0+IHtcclxuICBsZXQgY29sb3IgPSBnZXRTdHlsZShlbGUsIFwiYmFja2dyb3VuZENvbG9yXCIpO1xyXG4gIHNldFN0eWxlKGVsZSwge1xyXG4gICAgYmFja2dyb3VuZDogYHVybCgke3NyY30pIGNlbnRlci80ZW0gbm8tcmVwZWF0ICR7Y29sb3J9YFxyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgZGFtcCA9ICh4LCBtYXgpID0+IHtcclxuICBsZXQgdW5pdCA9ICh4KSA9PiB7XHJcbiAgICByZXR1cm4gTWF0aC5hdGFuKHgpIC8gKE1hdGguUEkgLyAyKTtcclxuICB9O1xyXG4gIGxldCBjb250cmFjdGlvbiA9ICh4LCBtYXgpID0+IHtcclxuICAgIHJldHVybiB4IC8gbWF4O1xyXG4gIH07XHJcbiAgcmV0dXJuIHVuaXQoY29udHJhY3Rpb24oeCwgbWF4KSkgKiBtYXg7XHJcbn07XHJcbmV4cG9ydCB7XHJcbiAgc2V0U3R5bGUsXHJcbiAgc2V0SGVpZ2h0LFxyXG4gIHNldEJvcmRlcixcclxuICBjbGVhckhlaWdodCxcclxuICBjbGVhckJvcmRlcixcclxuICBkYW1wLFxyXG4gIHNldExvYWRpbmdJbWcsXHJcbiAgY2xlYXJMb2FkaW5nSW1nXHJcbn07XHJcbiIsImltcG9ydCB7IHNldFN0eWxlfSBmcm9tIFwiLi4vdXRpbHNcIjtcclxuXHJcbmNvbnN0IGRlZmF1bHRPcHRpb25zID0ge1xyXG4gIHRpbWU6IDMwMCxcclxuICBtYXg6IDgwLFxyXG4gIGJnOiBcIiNmMGYwZjBcIixcclxuICBjYjogKCkgPT4ge30sXHJcbiAgc3RhZ2UxQmVnaW46IChlbGUsIG9iaikgPT4ge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXHJcbiAgICBsZXQgeyB5LCBiZyB9ID0gb2JqO1xyXG4gICAgc2V0U3R5bGUoZWxlLCB7XHJcbiAgICAgIHRleHQ6IFwi5LiL5ouJ5Yi35pawXCIsXHJcbiAgICAgIGNvbG9yOiBcIiM2N2MyM2FcIixcclxuICAgICAgdGV4dEFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgICBsaW5lSGVpZ2h0OiBgJHt5fXB4YFxyXG4gICAgfSk7XHJcbiAgfSxcclxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcclxuICBzdGFnZTJCZWdpbjogKGVsZSwgb2JqKSA9PiB7XHJcbiAgICBzZXRTdHlsZShlbGUsIHtcclxuICAgICAgdGV4dDogXCLmnb7lvIDliLfmlrBcIlxyXG4gICAgfSk7XHJcbiAgfSxcclxuICBzdGFnZTFFbmQ6IChlbGUsIGZsYWcpID0+IHtcclxuICAgIGlmKGZsYWcpIHtcclxuICAgICAgc2V0U3R5bGUoZWxlLCB7XHJcbiAgICAgICAgdGV4dDogXCLliLfmlrDmiJDlip9cIlxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldFN0eWxlKGVsZSx7XHJcbiAgICAgICAgdGV4dDogXCLliLfmlrDlpLHotKVcIixcclxuICAgICAgICBjb2xvcjogXCIjZjU2YzZjXCJcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBzdGFnZTJFbmQ6IChlbGUpID0+IHtcclxuICAgIHNldFN0eWxlKGVsZSwge1xyXG4gICAgICB0ZXh0OiBcIuWIt+aWsOS4rS4uLlwiXHJcbiAgICB9KTtcclxuICB9LFxyXG4gIHN0YWdlMjogKCkgPT4ge30sXHJcbiAgZHVyYXRpb246IDI1MCxcclxufTtcclxuZXhwb3J0IHtcclxuICBkZWZhdWx0T3B0aW9uc1xyXG59O1xyXG4iLCJjb25zdCB1cGRhdGVEYXRhSW5TdGFydCA9IChkYXRhLCBlLCBvcHRpb25zKSA9PiB7XG4gIGxldCBlbGUgPSBvcHRpb25zLmVsZSxcbiAgW3RvcCwgYm90dG9tXSA9IHRvcEFuZEJvdHRvbShlbGUpO1xuICBpZihkYXRhLnBoYXNlID09PSAtMSAmJiAodG9wIHx8IGJvdHRvbSkpIHtcbiAgICBkYXRhLnN0YXJ0ID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuICAgIGRhdGEucGhhc2UgPSAwO1xuICAgIGRhdGEudG9wID0gdG9wO1xuICAgIGRhdGEuYm90dG9tID0gYm90dG9tO1xuICB9XG59XG5jb25zdCB1cGRhdGVEYXRhSW5Nb3ZlID0gKGRhdGEsIGUsIG9wdGlvbnMpID0+IHtcbiAgbGV0IG1vdmUgPSBlLnRvdWNoZXNbMF0ucGFnZVksXG4gICAgc3RhcnQgPSBkYXRhLnN0YXJ0LFxuICAgIGVsZSA9IG9wdGlvbnMuZWxlLFxuICAgIFt0b3AsIGJvdHRvbV0gPSB0b3BBbmRCb3R0b20oZWxlKSxcbiAgICB5ID0gbW92ZSAtIHN0YXJ0LFxuICAgIHBvc2l0aXZlID0geSA+PSAwLFxuICAgIG5lZ2F0aXZlID0geSA8PSAwO1xuICBpZihkYXRhLnBoYXNlID09PSAwIHx8IGRhdGEucGhhc2UgPT09IDEpIHtcbiAgICBpZih0b3AgJiYgcG9zaXRpdmUgfHwgYm90dG9tICYmIG5lZ2F0aXZlKSB7XG4gICAgICBkYXRhLnBoYXNlID0gMTtcbiAgICAgIGRhdGEueSA9IHk7XG4gICAgICBkYXRhLnBvc2l0aXZlID0gcG9zaXRpdmU7XG4gICAgICBkYXRhLm5lZ2F0aXZlID0gbmVnYXRpdmU7XG4gICAgICBkYXRhLnRvcCA9IHRvcDtcbiAgICAgIGRhdGEuYm90dG9tID0gYm90dG9tO1xuICAgIH1cbiAgfVxuXG4gIC8vIChkYXRhLnBoYXNlID09PSAwKSAmJiAoZGF0YS5waGFzZSA9IDEpO1xuICAvLyBpZihkYXRhLnBoYXNlID09PSAxKSB7XG4gIC8vICAgZGF0YS55ID0gbW92ZSAtIHN0YXJ0O1xuICAvLyAgIGRhdGEucG9zaXRpdmUgPSBkYXRhLnkgPj0gMDtcbiAgLy8gICBkYXRhLm5lZ2F0aXZlID0gIWRhdGEucG9zaXRpdmU7XG4gIC8vICAgZGF0YS50b3AgPSBlbGUuc2Nyb2xsVG9wID09PSAwO1xuICAvLyAgIGRhdGEuYm90dG9tID0gZWxlLnNjcm9sbFRvcCArIGVsZS5jbGllbnRIZWlnaHQgPT09IGVsZS5zY3JvbGxIZWlnaHQ7XG4gIC8vIH1cbn1cblxuY29uc3QgdXBkYXRlRGF0YUluQ2FuY2VsID0gKGRhdGEsIGUsIG9wdGlvbnMpID0+IHtcbiAgLy8gaWYoZGF0YS50b3AgfHwgZGF0YS5ib3R0b20pIHtcbiAgLy8gICAoZGF0YS5waGFzZSA9PT0gMSkgJiYgKGRhdGEucGhhc2UgPSAyKVxuICAvLyB9XG4gIGxldCBlbGUgPSBvcHRpb25zLmVsZSxcbiAgICBbdG9wLCBib3R0b20gXSA9IHRvcEFuZEJvdHRvbShlbGUpO1xuICBkYXRhLnRvcCA9IHRvcDtcbiAgZGF0YS5ib3R0b20gPSBib3R0b207XG59XG5cbmNvbnN0IHRvcEFuZEJvdHRvbSA9IChlbGUpID0+IHtcbiAgcmV0dXJuIFtcbiAgICBlbGUuc2Nyb2xsVG9wID09PSAwLFxuICAgIGVsZS5zY3JvbGxUb3AgKyBlbGUuY2xpZW50SGVpZ2h0ID49IGVsZS5zY3JvbGxIZWlnaHRcbiAgXVxufVxuXG5leHBvcnQge1xuICB1cGRhdGVEYXRhSW5TdGFydCxcbiAgdXBkYXRlRGF0YUluTW92ZSxcbiAgdXBkYXRlRGF0YUluQ2FuY2VsXG59XG4iLCJpbXBvcnQge2RlZmF1bHRPcHRpb25zfSBmcm9tIFwiLi9kZWZhdWx0XCI7XHJcbmltcG9ydCB7XHJcbiAgY2xlYXJCb3JkZXIsXHJcbiAgY2xlYXJIZWlnaHQsXHJcbiAgc2V0Qm9yZGVyLFxyXG4gIHNldEhlaWdodCxcclxuICBzZXRTdHlsZVxyXG59IGZyb20gXCIuLi91dGlscy9pbmRleFwiO1xyXG5pbXBvcnQge1xyXG4gIHVwZGF0ZURhdGFJblN0YXJ0LFxyXG4gIHVwZGF0ZURhdGFJbk1vdmUsXHJcbiAgdXBkYXRlRGF0YUluQ2FuY2VsXHJcbn0gZnJvbSBcIi4vaGVscGVyc1wiO1xyXG5cclxuY2xhc3MgVkxvYWRpbmcge1xyXG4gIGNvbnN0cnVjdG9yKGVsZSwgb3B0aW9ucykge1xyXG4gICAgdGhpcy5lbGUgPSBlbGU7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBPYmplY3QuYXNzaWduKGRlZmF1bHRPcHRpb25zLCBvcHRpb25zLCB7IGVsZSB9KTtcclxuICAgIHRoaXMuZGF0YSA9IHtcclxuICAgICAgdG9wOiBmYWxzZSwgICAgIC8vIOaYr+WQpuinpumhtlxyXG4gICAgICBib3R0b206IGZhbHNlLCAgLy8g5piv5ZCm6Kem5bqVXHJcbiAgICAgIHk6IDAsICAgICAgICAgICAvLyDot6/nqIvkvY3np7tcclxuICAgICAgc3RhcnQ6IDAsICAgICAgIC8vIOi1t+eCueS9jeenu1xyXG4gICAgICBwaGFzZTogLTEsICAgICAgLy8gMDp0b3VjaHN0YXJ0LCAxOnRvdWNobW92ZSwgMjp0b3VjaGVuZC9jYW5jZWwsIC0xLCBubyBldmVudHNcclxuICAgIH07XHJcbiAgICB0aGlzLmluc2VydFRvcExvYWRpbmcoKTtcclxuICAgIHRoaXMuaW5zZXJ0Qm90dG9tTG9hZGluZygpO1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbiAgfVxyXG4gIGluc2VydFRvcExvYWRpbmcoKSB7XHJcbiAgICBjb25zdCBsb2FkaW5nID0gdGhpcy5vcHRpb25zLnRvcExvYWRpbmc7XHJcbiAgICBpZihsb2FkaW5nKVxyXG4gICAgICByZXR1cm47XHJcbiAgICBsZXQgZmlyc3ROb2RlID0gdGhpcy5lbGUuZmlyc3RFbGVtZW50Q2hpbGQsXHJcbiAgICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBzZXRTdHlsZShkaXYsIHtcclxuICAgICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCJcclxuICAgIH0pO1xyXG4gICAgdGhpcy5lbGUuaW5zZXJ0QmVmb3JlKGRpdiwgZmlyc3ROb2RlKTtcclxuICAgIHRoaXMub3B0aW9ucy50b3BMb2FkaW5nID0gZGl2O1xyXG4gIH1cclxuICBpbnNlcnRCb3R0b21Mb2FkaW5nKCkge1xyXG4gICAgY29uc3QgYm90dG9tTG9hZGluZyA9IHRoaXMub3B0aW9ucy5ib3R0b21Mb2FkaW5nO1xyXG4gICAgaWYoYm90dG9tTG9hZGluZylcclxuICAgICAgcmV0dXJuO1xyXG4gICAgbGV0IGxhc3ROb2RlID0gdGhpcy5lbGUubGFzdEVsZW1lbnRDaGlsZCxcclxuICAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGRpdi5pbm5lclRleHQgPSBcIuS4iuaLieWKoOi9veS4rS4uLlwiO1xyXG4gICAgc2V0U3R5bGUoZGl2LCB7XHJcbiAgICAgIGxpbmVIZWlnaHQ6IDIsXHJcbiAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcclxuICAgICAgdmlzaWJpbGl0eTogXCJoaWRkZW5cIlxyXG4gICAgfSk7XHJcbiAgICB0aGlzLmVsZS5pbnNlcnRCZWZvcmUoZGl2LCBsYXN0Tm9kZS5uZXh0U2libGluZyk7XHJcbiAgICB0aGlzLm9wdGlvbnMuYm90dG9tTG9hZGluZyA9IGRpdjtcclxuICB9XHJcbiAgaW5pdCgpIHtcclxuICAgIGxldCBlbGUgPSB0aGlzLmVsZSxcclxuICAgICAgZGF0YSA9IHRoaXMuZGF0YSxcclxuICAgICAgdG9wTG9hZGluZyA9IHRoaXMub3B0aW9ucy50b3BMb2FkaW5nLFxyXG4gICAgICBib3R0b21Mb2FkaW5nID0gdGhpcy5vcHRpb25zLmJvdHRvbUxvYWRpbmcsXHJcbiAgICAgIGNiID0gdGhpcy5vcHRpb25zLmNiLFxyXG4gICAgICBtYXggPSB0aGlzLm9wdGlvbnMubWF4LFxyXG4gICAgICBiZyA9IHRoaXMub3B0aW9ucy5iZyxcclxuICAgICAgdGltZSA9IHRoaXMub3B0aW9ucy50aW1lLFxyXG4gICAgICBkdXJhdGlvbiA9IHRoaXMub3B0aW9ucy5kdXJhdGlvbixcclxuICAgICAgc3RhZ2UxQmVnaW4gPSB0aGlzLm9wdGlvbnMuc3RhZ2UxQmVnaW4sXHJcbiAgICAgIHN0YWdlMkJlZ2luID0gdGhpcy5vcHRpb25zLnN0YWdlMkJlZ2luLFxyXG4gICAgICBzdGFnZTFFbmQgPSB0aGlzLm9wdGlvbnMuc3RhZ2UxRW5kLFxyXG4gICAgICBzdGFnZTJFbmQgPSB0aGlzLm9wdGlvbnMuc3RhZ2UyRW5kO1xyXG4gICAgd2luZG93LmRhdGEgPSBkYXRhO1xyXG4gICAgZWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChlKSA9PiB7XHJcbiAgICAgIHVwZGF0ZURhdGFJblN0YXJ0KGRhdGEsIGUsIHRoaXMub3B0aW9ucyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBlbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCAoZSkgPT4ge1xyXG4gICAgICB1cGRhdGVEYXRhSW5Nb3ZlKGRhdGEsIGUsIHRoaXMub3B0aW9ucyk7XHJcbiAgICAgIGlmKGRhdGEucGhhc2UgPT09IDApXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICBpZihkYXRhLnBoYXNlID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZihkYXRhLnBoYXNlID09PSAyKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZihkYXRhLnRvcCkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBsZXQgeSA9IGRhdGEueTtcclxuXHJcbiAgICAgICAgaWYoeSA+PSBtYXgpIHtcclxuICAgICAgICAgIHkgPSAoeSAtIG1heCkgLyAyO1xyXG4gICAgICAgICAgc2V0Qm9yZGVyKHRvcExvYWRpbmcsIHsgeSwgYmcgfSk7XHJcbiAgICAgICAgICBzdGFnZTJCZWdpbih0b3BMb2FkaW5nLCB7IHksIGJnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzZXRIZWlnaHQodG9wTG9hZGluZywgeyB5LCBiZyB9KTtcclxuICAgICAgICAgIHN0YWdlMUJlZ2luKHRvcExvYWRpbmcsIHsgeSwgYmcgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKGRhdGEuYm90dG9tKSB7XHJcbiAgICAgICAgc2V0U3R5bGUoYm90dG9tTG9hZGluZywge1xyXG4gICAgICAgICAgdmlzaWJpbGl0eTogXCJ2aXNpYmxlXCJcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gfVxyXG4gICAgfSwge3Bhc3NpdmU6IGZhbHNlfSk7XHJcbiAgICBlbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIChlKSA9PiB7XHJcbiAgICAgIHVwZGF0ZURhdGFJbkNhbmNlbChkYXRhLCBlLCB0aGlzLm9wdGlvbnMpO1xyXG4gICAgICBpZihkYXRhLnBoYXNlID09PSAwKSB7XHJcbiAgICAgICAgZGF0YS5waGFzZSA9IC0xO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZihkYXRhLnBoYXNlID09PSAxKSB7XHJcbiAgICAgICAgZGF0YS5waGFzZSA9IDI7XHJcbiAgICAgICAgaWYoZGF0YS50b3ApIHtcclxuICAgICAgICAgIGxldCB5ID0gZGF0YS55O1xyXG4gICAgICAgICAgaWYoeSA+IG1heCkge1xyXG4gICAgICAgICAgICBjbGVhckJvcmRlcih0b3BMb2FkaW5nLG51bGwsIGR1cmF0aW9uKTtcclxuICAgICAgICAgICAgc3RhZ2UyRW5kKHRvcExvYWRpbmcpO1xyXG4gICAgICAgICAgICBjYihcclxuICAgICAgICAgICAgICAoZmxhZykgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3RhZ2UxRW5kKHRvcExvYWRpbmcsZmxhZyk7XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY2xlYXJIZWlnaHQodG9wTG9hZGluZywgZGF0YSwgZHVyYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfSwgdGltZSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gc3RhZ2UxRW5kKHRvcExvYWRpbmcpO1xyXG4gICAgICAgICAgICBjbGVhckJvcmRlcih0b3BMb2FkaW5nLCBkYXRhLCBkdXJhdGlvbik7XHJcbiAgICAgICAgICAgIGNsZWFySGVpZ2h0KHRvcExvYWRpbmcsIGRhdGEsIGR1cmF0aW9uKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZGF0YS5ib3R0b20pIHtcclxuICAgICAgICAgIHNldFN0eWxlKGJvdHRvbUxvYWRpbmcsIHtcclxuICAgICAgICAgICAgdmlzaWJpbGl0eTogXCJoaWRkZW5cIlxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBkYXRhLnBoYXNlID0gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGVsZS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hjYW5jZWxcIiwgKGUpID0+IHtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBWTG9hZGluZztcclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTSxRQUFRLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxLQUFLO0FBQy9CLEVBQUUsS0FBSyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO0FBQ3RDLElBQUksSUFBSSxLQUFLLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBQzdCLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQztBQUNyQixJQUFJLEdBQUcsR0FBRyxLQUFLLE1BQU07QUFDckIsTUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDO0FBQ3pCLElBQUksR0FBRyxHQUFHLEtBQUssTUFBTTtBQUNyQixNQUFNLElBQUksR0FBRyxXQUFXLENBQUM7QUFDekIsSUFBSSxHQUFHLE9BQU8sR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLFFBQVE7QUFDcEMsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBQzdCO0FBQ0EsTUFBTSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBQ3hCLEdBQUc7QUFDSCxDQUFDLENBQUM7QUFJRjtBQUNBLE1BQU0sV0FBVyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxRQUFRLEdBQUcsR0FBRyxLQUFLO0FBQ25ELEVBQUUsUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNoQixJQUFJLGNBQWMsRUFBRSxxQkFBcUI7QUFDekMsSUFBSSxZQUFZLEVBQUUsQ0FBQyxjQUFjLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQztBQUMvQyxHQUFHLENBQUMsQ0FBQztBQUNMLEVBQUUsVUFBVSxDQUFDLE1BQU07QUFDbkIsSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFO0FBQ2xCLE1BQU0sWUFBWSxFQUFFLE1BQU07QUFDMUIsS0FBSyxDQUFDLENBQUM7QUFDUCxJQUFJLENBQUMsSUFBSSxNQUFNLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDZixDQUFDLENBQUM7QUFDRjtBQUNBLE1BQU0sV0FBVyxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxRQUFRLEdBQUcsR0FBRyxLQUFLO0FBQ25ELEVBQUUsUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNoQixJQUFJLE1BQU0sRUFBRSxHQUFHO0FBQ2YsSUFBSSxVQUFVLEVBQUUsQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQztBQUN0QyxHQUFHLENBQUMsQ0FBQztBQUNMLEVBQUUsVUFBVSxDQUFDLE1BQU07QUFDbkIsSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFO0FBQ2xCLE1BQU0sWUFBWSxFQUFFLE1BQU07QUFDMUIsS0FBSyxDQUFDLENBQUM7QUFDUCxJQUFJLENBQUMsSUFBSSxNQUFNLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNoQyxHQUFHLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFDZixDQUFDLENBQUM7QUFPRjtBQUNBLE1BQU0sU0FBUyxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxLQUFLLEdBQUcsU0FBUyxLQUFLO0FBQ25ELEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxHQUFHLENBQUM7QUFDdEIsRUFBRSxFQUFFLEdBQUcsRUFBRSxJQUFJLEtBQUssQ0FBQztBQUNuQixFQUFFLFFBQVEsQ0FBQyxHQUFHLEVBQUU7QUFDaEIsSUFBSSxjQUFjLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDeEMsSUFBSSxVQUFVLEVBQUUsTUFBTTtBQUN0QixHQUFHLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQztBQUNGO0FBQ0EsTUFBTSxTQUFTLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxTQUFTLEtBQUs7QUFDbEQsRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEdBQUcsQ0FBQztBQUN0QixFQUFFLEVBQUUsR0FBRyxFQUFFLElBQUksS0FBSyxDQUFDO0FBQ25CLEVBQUUsUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNoQixJQUFJLE1BQU0sRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUNwQixJQUFJLFVBQVUsRUFBRSxFQUFFO0FBQ2xCLElBQUksVUFBVSxFQUFFLE1BQU07QUFDdEIsR0FBRyxDQUFDLENBQUM7QUFDTCxDQUFDOztBQ2pFRCxNQUFNLGNBQWMsR0FBRztBQUN2QixFQUFFLElBQUksRUFBRSxHQUFHO0FBQ1gsRUFBRSxHQUFHLEVBQUUsRUFBRTtBQUNULEVBQUUsRUFBRSxFQUFFLFNBQVM7QUFDZixFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUU7QUFDZCxFQUFFLFdBQVcsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEtBQUs7QUFDN0I7QUFDQSxJQUFJLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsR0FBRyxDQUFDO0FBQ3hCLElBQUksUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNsQixNQUFNLElBQUksRUFBRSxNQUFNO0FBQ2xCLE1BQU0sS0FBSyxFQUFFLFNBQVM7QUFDdEIsTUFBTSxTQUFTLEVBQUUsUUFBUTtBQUN6QixNQUFNLFVBQVUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUMxQixLQUFLLENBQUMsQ0FBQztBQUNQLEdBQUc7QUFDSDtBQUNBLEVBQUUsV0FBVyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsS0FBSztBQUM3QixJQUFJLFFBQVEsQ0FBQyxHQUFHLEVBQUU7QUFDbEIsTUFBTSxJQUFJLEVBQUUsTUFBTTtBQUNsQixLQUFLLENBQUMsQ0FBQztBQUNQLEdBQUc7QUFDSCxFQUFFLFNBQVMsRUFBRSxDQUFDLEdBQUcsRUFBRSxJQUFJLEtBQUs7QUFDNUIsSUFBSSxHQUFHLElBQUksRUFBRTtBQUNiLE1BQU0sUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNwQixRQUFRLElBQUksRUFBRSxNQUFNO0FBQ3BCLE9BQU8sQ0FBQyxDQUFDO0FBQ1QsS0FBSyxNQUFNO0FBQ1gsTUFBTSxRQUFRLENBQUMsR0FBRyxDQUFDO0FBQ25CLFFBQVEsSUFBSSxFQUFFLE1BQU07QUFDcEIsUUFBUSxLQUFLLEVBQUUsU0FBUztBQUN4QixPQUFPLENBQUMsQ0FBQztBQUNULEtBQUs7QUFDTCxHQUFHO0FBQ0gsRUFBRSxTQUFTLEVBQUUsQ0FBQyxHQUFHLEtBQUs7QUFDdEIsSUFBSSxRQUFRLENBQUMsR0FBRyxFQUFFO0FBQ2xCLE1BQU0sSUFBSSxFQUFFLFFBQVE7QUFDcEIsS0FBSyxDQUFDLENBQUM7QUFDUCxHQUFHO0FBQ0gsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFO0FBQ2xCLEVBQUUsUUFBUSxFQUFFLEdBQUc7QUFDZixDQUFDOztBQzFDRCxNQUFNLGlCQUFpQixHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxPQUFPLEtBQUs7QUFDaEQsRUFBRSxJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRztBQUN2QixFQUFFLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNwQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksTUFBTSxDQUFDLEVBQUU7QUFDM0MsSUFBSSxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO0FBQ3BDLElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7QUFDbkIsSUFBSSxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNuQixJQUFJLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0FBQ3pCLEdBQUc7QUFDSCxFQUFDO0FBQ0QsTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsT0FBTyxLQUFLO0FBQy9DLEVBQUUsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLO0FBQy9CLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLO0FBQ3RCLElBQUksR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHO0FBQ3JCLElBQUksQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQztBQUNyQyxJQUFJLENBQUMsR0FBRyxJQUFJLEdBQUcsS0FBSztBQUNwQixJQUFJLFFBQVEsR0FBRyxDQUFDLElBQUksQ0FBQztBQUNyQixJQUFJLFFBQVEsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3RCLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxLQUFLLENBQUMsSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLENBQUMsRUFBRTtBQUMzQyxJQUFJLEdBQUcsR0FBRyxJQUFJLFFBQVEsSUFBSSxNQUFNLElBQUksUUFBUSxFQUFFO0FBQzlDLE1BQU0sSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7QUFDckIsTUFBTSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNqQixNQUFNLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0FBQy9CLE1BQU0sSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7QUFDL0IsTUFBTSxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNyQixNQUFNLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0FBQzNCLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0EsTUFBTSxrQkFBa0IsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsT0FBTyxLQUFLO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLEVBQUUsSUFBSSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUc7QUFDdkIsSUFBSSxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUUsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDdkMsRUFBRSxJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztBQUNqQixFQUFFLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0FBQ3ZCLEVBQUM7QUFDRDtBQUNBLE1BQU0sWUFBWSxHQUFHLENBQUMsR0FBRyxLQUFLO0FBQzlCLEVBQUUsT0FBTztBQUNULElBQUksR0FBRyxDQUFDLFNBQVMsS0FBSyxDQUFDO0FBQ3ZCLElBQUksR0FBRyxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsWUFBWSxJQUFJLEdBQUcsQ0FBQyxZQUFZO0FBQ3hELEdBQUc7QUFDSDs7QUN4Q0EsTUFBTSxRQUFRLENBQUM7QUFDZixFQUFFLFdBQVcsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFO0FBQzVCLElBQUksSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUM7QUFDbkIsSUFBSSxJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLE9BQU8sRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFDbkUsSUFBSSxJQUFJLENBQUMsSUFBSSxHQUFHO0FBQ2hCLE1BQU0sR0FBRyxFQUFFLEtBQUs7QUFDaEIsTUFBTSxNQUFNLEVBQUUsS0FBSztBQUNuQixNQUFNLENBQUMsRUFBRSxDQUFDO0FBQ1YsTUFBTSxLQUFLLEVBQUUsQ0FBQztBQUNkLE1BQU0sS0FBSyxFQUFFLENBQUMsQ0FBQztBQUNmLEtBQUssQ0FBQztBQUNOLElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7QUFDNUIsSUFBSSxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztBQUMvQixJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNoQixHQUFHO0FBQ0gsRUFBRSxnQkFBZ0IsR0FBRztBQUNyQixJQUFJLE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQzVDLElBQUksR0FBRyxPQUFPO0FBQ2QsTUFBTSxPQUFPO0FBQ2IsSUFBSSxJQUFJLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLGlCQUFpQjtBQUM5QyxNQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzFDLElBQUksUUFBUSxDQUFDLEdBQUcsRUFBRTtBQUNsQixNQUFNLFFBQVEsRUFBRSxRQUFRO0FBQ3hCLEtBQUssQ0FBQyxDQUFDO0FBQ1AsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDMUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUM7QUFDbEMsR0FBRztBQUNILEVBQUUsbUJBQW1CLEdBQUc7QUFDeEIsSUFBSSxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQztBQUNyRCxJQUFJLEdBQUcsYUFBYTtBQUNwQixNQUFNLE9BQU87QUFDYixJQUFJLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsZ0JBQWdCO0FBQzVDLE1BQU0sR0FBRyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDMUMsSUFBSSxHQUFHLENBQUMsU0FBUyxHQUFHLFVBQVUsQ0FBQztBQUMvQixJQUFJLFFBQVEsQ0FBQyxHQUFHLEVBQUU7QUFDbEIsTUFBTSxVQUFVLEVBQUUsQ0FBQztBQUNuQixNQUFNLFNBQVMsRUFBRSxRQUFRO0FBQ3pCLE1BQU0sVUFBVSxFQUFFLFFBQVE7QUFDMUIsS0FBSyxDQUFDLENBQUM7QUFDUCxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDckQsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsR0FBRyxHQUFHLENBQUM7QUFDckMsR0FBRztBQUNILEVBQUUsSUFBSSxHQUFHO0FBQ1QsSUFBSSxJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRztBQUN0QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSTtBQUN0QixNQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVU7QUFDMUMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFhO0FBQ2hELE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRTtBQUMxQixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUc7QUFDNUIsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO0FBQzFCLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSTtBQUM5QixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVE7QUFDdEMsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXO0FBQzVDLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVztBQUM1QyxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVM7QUFDeEMsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDekMsSUFBSSxNQUFNLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztBQUN2QixJQUFJLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDLEtBQUs7QUFDOUMsTUFBTSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUMvQyxLQUFLLENBQUMsQ0FBQztBQUNQO0FBQ0EsSUFBSSxHQUFHLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxLQUFLO0FBQzdDLE1BQU0sZ0JBQWdCLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDOUMsTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLEtBQUssQ0FBQztBQUN6QixRQUFRLE9BQU87QUFDZixNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUMsRUFBRTtBQUM1QixRQUFRLE9BQU87QUFDZixPQUFPO0FBQ1AsTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLEtBQUssQ0FBQyxFQUFFO0FBQzNCLFFBQVEsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO0FBQzNCLFFBQVEsT0FBTztBQUNmLE9BQU87QUFDUCxNQUFNLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRTtBQUNuQixRQUFRLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztBQUMzQixRQUFRLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDdkI7QUFDQSxRQUFRLEdBQUcsQ0FBQyxJQUFJLEdBQUcsRUFBRTtBQUNyQixVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxDQUFDO0FBQzVCLFVBQVUsU0FBUyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzNDLFVBQVUsV0FBVyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzdDLFNBQVMsTUFBTTtBQUNmLFVBQVUsU0FBUyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzNDLFVBQVUsV0FBVyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzdDLFNBQVM7QUFDVCxPQUFPO0FBQ1AsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDdEIsUUFBUSxRQUFRLENBQUMsYUFBYSxFQUFFO0FBQ2hDLFVBQVUsVUFBVSxFQUFFLFNBQVM7QUFDL0IsU0FBUyxDQUFDLENBQUM7QUFDWCxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUssRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3pCLElBQUksR0FBRyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsS0FBSztBQUM1QyxNQUFNLGtCQUFrQixDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ2hELE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxLQUFLLENBQUMsRUFBRTtBQUMzQixRQUFRLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDeEIsUUFBUSxPQUFPO0FBQ2YsT0FBTztBQUNQLE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxLQUFLLENBQUMsRUFBRTtBQUMzQixRQUFRLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZCLFFBQVEsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFO0FBQ3JCLFVBQVUsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUN6QixVQUFVLEdBQUcsQ0FBQyxHQUFHLEdBQUcsRUFBRTtBQUN0QixZQUFZLFdBQVcsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQ25ELFlBQVksU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ2xDLFlBQVksRUFBRTtBQUNkLGNBQWMsQ0FBQyxJQUFJLEtBQUs7QUFDeEIsZ0JBQWdCLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDM0MsZ0JBQWdCLFVBQVUsQ0FBQyxNQUFNO0FBQ2pDLGtCQUFrQixXQUFXLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztBQUMxRCxpQkFBaUIsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN6QixlQUFlO0FBQ2YsYUFBYSxDQUFDO0FBQ2QsV0FBVyxNQUFNO0FBQ2pCO0FBQ0EsWUFBWSxXQUFXLENBQUMsVUFBVSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztBQUNwRCxZQUFZLFdBQVcsQ0FBQyxVQUFVLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQ3BELFdBQVc7QUFDWCxTQUFTO0FBQ1QsUUFBUSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDeEIsVUFBVSxRQUFRLENBQUMsYUFBYSxFQUFFO0FBQ2xDLFlBQVksVUFBVSxFQUFFLFFBQVE7QUFDaEMsV0FBVyxDQUFDLENBQUM7QUFDYixVQUFVLElBQUksQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDMUIsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLLENBQUMsQ0FBQztBQUNQLElBQUksR0FBRyxDQUFDLGdCQUFnQixDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsS0FBSztBQUMvQyxLQUFLLENBQUMsQ0FBQztBQUNQLEdBQUc7QUFDSDs7OzsifQ==
